<a href="https://www.hackerrank.com/challenges/full-score/problem">Задача описана тут</a>

Решала изнутри - сначала вложенные запрос писала, тестировала, потом оборачивала сверху. Это позволило мне написать все с первого раза. Без мелких ошибок. Что просто супер)))
Второй вариант запроса для примера с использованием полного синтаксиса join.

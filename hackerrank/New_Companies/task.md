<a href="https://www.hackerrank.com/challenges/the-company/problem">Задача описана тут</a>

Решение приведенное в solution само по себе поясняет порядок происходящего. Выполнена группировка отдельно по всем таблицам, получены нужные количества. После этого все таблицы соединены по общему ключу.

Решение в solution2 короче. Но его логика сложнее. Выбор идет по одной таблице. Соединение выполнено по разным ключам. Но джойн может быть более затратным, т.к. объединяяется большее кол-во строк.
